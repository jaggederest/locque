import prelude as P
import assert as A
import typeclass::equality as Eq

module test::new_syntax_test contains
  define transparent const-five as
    function ignored Natural returns Natural value
      5
    end

  define transparent add-wrapper as
    function x Natural y Natural returns Natural value
      P::add-nat x y
    end

  define transparent test-let as
    function x Natural returns Natural value
      let value y be (P::add-nat x 10) in
        let value z be (P::add-nat y 5) in
          z
        end
      end
    end

  define transparent test-bind as compute
    bind result from return 42 then
      perform (P::sequence-unit
        [
          (A::assert-eq Natural result 42)
        ])
    end
  end

  define transparent main as compute
    perform (P::sequence-unit
      [
        (A::assert-eq Natural (const-five 0) 5)
      , (A::assert-eq Natural (add-wrapper 3 4) 7)
      , (A::assert-eq Natural (test-let 1) 16)
      , test-bind
      ])
  end
end
