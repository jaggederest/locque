import Tools::MexprToSexpr as Conv
import Assert as A
import Prelude as P

module MexprToSexprTests contains

  define transparent sample as value "module Hello contains define transparent message as value \"hi\" end"

  define transparent check-convert as computation
    bind out <- Conv.convert-string sample then
    bind _ <- perform io (A.assert-eq-string out "(module Hello (def transparent message (value \"hi\")))") then
    return P.tt

  define transparent empty-sample as value "module Empty contains end"

  define transparent check-empty as computation
    bind out <- Conv.convert-string empty-sample then
    bind _ <- perform io (A.assert-eq-string out "(module Empty)") then
    return P.tt

  define transparent main as computation
    bind _ <- check-convert then
    bind _ <- check-empty then
    return P.tt
end
