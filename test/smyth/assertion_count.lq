# Test: Assertion counting
# This file tests that the assertion counter correctly counts all assertions
# Expected: 5 assertions

import Prelude as P
import Assert as A
import IO as IO

module SmythAssertionCount contains

  define transparent test-five-assertions as computation
    bind _ <- perform io (A.assert-eq-nat 1 1) then
    bind _ <- perform io (A.assert-eq-nat 2 2) then
    bind _ <- perform io (A.assert-eq-nat 3 3) then
    bind _ <- perform io (A.assert-eq-string "a" "a") then
    bind _ <- perform io (A.assert-eq-string "b" "b") then
    return P.tt

  define transparent main as computation
    perform io test-five-assertions

end
