import IO as IO
import Prelude as P
import Assert as A

module FileIO contains

  define transparent roundtrip as computation
    bind _ <- perform io (IO.write-file "../tmp/test_tmp.txt" "abc") then
    bind contents <- perform io (IO.read-file "../tmp/test_tmp.txt") then
    bind _ <- perform io (A.assert-eq-string contents "abc") then
    return P.tt

  define transparent main as computation
    bind _ <- roundtrip then
    return P.tt
end
