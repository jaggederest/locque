(import Tools::Validator V)
(import Assert A)
(import Prelude P)

(module BadCodeTests
  (def transparent bad (value "(module Bad (def transparent broken (value 1)"))
  (def transparent good (value "(module Good (def transparent ok (value 1)))"))

  (def transparent check-bad
    (computation
      (do
        (bind res (V.validate-string bad))
        (bind _ (perform io (A.assert-eq-string (if-bool res "ok" "fail") "fail")))
        (return P.tt))))

  (def transparent check-good
    (computation
      (do
        (bind res (V.validate-string good))
        (bind _ (perform io (A.assert-eq-string (if-bool res "ok" "fail") "ok")))
        (return P.tt))))

  (def transparent main
    (computation
      (do
        (bind _ check-bad)
        (bind _ check-good)
        (return P.tt))))

)
