# Migrated from ../11_string_utils.lq

import prelude as P
import assert as A
import string as S

module LStringUtilsTests contains

  define transparent test-is-empty-whitespace as computation
    bind perform io (A.assert-eq-string (P.if-bool (S.is-empty "") "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.is-empty "hello") "yes" "no") "no") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.is-whitespace "   ") "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.is-whitespace "hello") "yes" "no") "no") as _ then
    return P.tt

  define transparent test-ends-with-index-of as computation
    bind perform io (A.assert-eq-string (P.if-bool (S.ends-with "lo" "hello") "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.ends-with "hi" "hello") "yes" "no") "no") as _ then
    bind perform io (A.assert-eq-nat (S.index-of "ell" "hello") 1) as _ then
    bind perform io (A.assert-eq-nat (S.index-of "xyz" "hello") 5) as _ then
    return P.tt

  define transparent test-reverse as computation
    bind perform io (A.assert-eq-string (S.reverse "hello") "olleh") as _ then
    bind perform io (A.assert-eq-string (S.reverse "a") "a") as _ then
    bind perform io (A.assert-eq-string (S.reverse "") "") as _ then
    return P.tt

  define transparent test-lines-unlines as computation
    bind S.lines "hello\nworld" as lines-result then
    bind perform io (A.assert-eq-nat (P.length-list lines-result) 2) as _ then
    bind perform io (A.assert-eq-string (S.unlines lines-result) "hello\nworld") as _ then
    return P.tt

  define transparent test-words-unwords as computation
    bind S.words "hello world test" as words-result then
    bind perform io (A.assert-eq-nat (P.length-list words-result) 3) as _ then
    bind P.head words-result as first-word then
    bind perform io (A.assert-eq-string first-word "hello") as _ then
    bind S.unwords words-result as rejoined then
    bind perform io (A.assert-eq-string rejoined "hello world test") as _ then
    return P.tt

  define transparent test-slice as computation
    bind perform io (A.assert-eq-string (S.slice 0 3 "hello") "hel") as _ then
    bind perform io (A.assert-eq-string (S.slice 2 3 "hello") "llo") as _ then
    bind perform io (A.assert-eq-string (S.slice 1 2 "hello") "el") as _ then
    return P.tt

  define transparent main as computation
    bind test-is-empty-whitespace as _ then
    bind test-ends-with-index-of as _ then
    bind test-reverse as _ then
    bind test-lines-unlines as _ then
    bind test-words-unwords as _ then
    bind test-slice as _ then
    return P.tt
end
