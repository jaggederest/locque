# String utilities smoke tests

import prelude as P
import assert as A
import string as S

open A exposing assert-eq Equality end
open S exposing Character end

module test::string::utils contains
  define transparent main as compute
    sequence
      (assert-eq Boolean (S::is-empty "") true)
      (assert-eq Boolean (S::is-empty "hello") false)
      (assert-eq Boolean (S::is-whitespace "   ") true)
      (assert-eq Boolean (S::is-whitespace "hello") false)
      (assert-eq Boolean (S::ends-with "lo" "hello") true)
      (assert-eq Boolean (S::ends-with "hi" "hello") false)
      (assert-eq Natural (S::index-of "ell" "hello") 1)
      (assert-eq Natural (S::index-of "xyz" "hello") 5)
      (assert-eq String (S::reverse "hello") "olleh")
      (assert-eq String (S::reverse "a") "a")
      (assert-eq String (S::reverse "") "")
      (assert-eq Natural (P::length-list String (S::lines "hello\nworld")) 2)
      (assert-eq String (S::unlines (S::lines "hello\nworld")) "hello\nworld")
      (assert-eq Natural (P::length-list String (S::words "hello world test")) 3)
      (assert-eq String (P::head String (S::words "hello world test")) "hello")
      (assert-eq String (S::unwords (S::words "hello world test")) "hello world test")
      (assert-eq String (S::slice 0 3 "hello") "hel")
      (assert-eq String (S::slice 2 3 "hello") "llo")
      (assert-eq String (S::slice 1 2 "hello") "el")
      (assert-eq Natural
        (P::length-list Character (S::to-list "hi"))
        2)
      (assert-eq String
        (S::character-string (P::head Character (S::to-list "hi")))
        "h")
      (assert-eq String
        (S::from-list
          (P::cons Character (S::character "a")
            (P::cons Character (S::character "b") (P::nil Character))))
        "ab")
      (assert-eq String (S::character-string (S::head "hi")) "h")
      (assert-eq String (S::tail "hi") "i")
      (assert-eq String (S::sort "dcba") "abcd")
    end
  end
end
