import prelude as P
import assert as A
import comparison as C
import arithmetic as Ar
import list as L
import string as S

module LPrimitiveTests contains

  define transparent test-comparison as computation
    bind perform io (A.assert-eq-string (P.if-bool (C.lt-nat 1 2) "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (C.gt-nat 2 1) "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (C.le-nat 2 2) "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (C.ge-nat 3 2) "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (C.eq-nat 5 5) "yes" "no") "yes") as _ then
    return P.tt

  define transparent test-arithmetic as computation
    bind perform io (A.assert-eq-nat (Ar.mul-nat 3 4) 12) as _ then
    bind perform io (A.assert-eq-nat (Ar.mul-nat (Ar.mul-nat 2 5) 3) 30) as _ then
    bind perform io (A.assert-eq-nat (Ar.div-nat 10 3) 3) as _ then
    bind perform io (A.assert-eq-nat (Ar.mod-nat 10 3) 1) as _ then
    bind perform io (A.assert-eq-nat (Ar.add-nat 5 10) 15) as _ then
    bind perform io (A.assert-eq-nat (Ar.sub-nat 10 3) 7) as _ then
    return P.tt

  define transparent test-list-ops as computation
    bind P.cons "a" (P.cons "b" (P.cons "c" P.nil)) as lst then
    bind perform io (A.assert-eq-string (L.nth 0 lst) "a") as _ then
    bind perform io (A.assert-eq-string (L.nth 1 lst) "b") as _ then
    bind perform io (A.assert-eq-string (L.nth 2 lst) "c") as _ then
    bind L.take 2 lst as taken then
    bind perform io (A.assert-eq-nat (P.length-list taken) 2) as _ then
    bind L.drop 1 lst as dropped then
    bind perform io (A.assert-eq-nat (P.length-list dropped) 2) as _ then
    bind perform io (A.assert-eq-string (L.nth 0 dropped) "b") as _ then
    return P.tt

  define transparent test-string-ops as computation
    bind perform io (A.assert-eq-string (S.substring 0 3 "hello") "hel") as _ then
    bind perform io (A.assert-eq-string (S.substring 2 3 "hello") "llo") as _ then
    bind perform io (A.assert-eq-string (S.char-at 1 "hello") "e") as _ then
    bind perform io (A.assert-eq-string (S.char-at 0 "hello") "h") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.string-contains "ell" "hello") "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.string-contains "xyz" "hello") "yes" "no") "no") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.string-starts-with "hel" "hello") "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.string-starts-with "llo" "hello") "yes" "no") "no") as _ then
    return P.tt

  define transparent main as computation
    bind test-comparison as _ then
    bind test-arithmetic as _ then
    bind test-list-ops as _ then
    bind test-string-ops as _ then
    return P.tt
end
