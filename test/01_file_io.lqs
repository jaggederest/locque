(import IO IO)
(import Prelude P)
(import Assert A)

(module FileIO
  (def transparent roundtrip
    (computation
      (do
        (bind _ (perform io (IO.write-file "../tmp/test_tmp.txt" "abc")))
        (bind contents (perform io (IO.read-file "../tmp/test_tmp.txt")))
        (bind _ (perform io (A.assert-eq-string contents "abc")))
        (return P.tt))))

  (def transparent main
    (computation
      (do
        (bind _ roundtrip)
        (return P.tt)))))
