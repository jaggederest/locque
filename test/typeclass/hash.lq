# Hash typeclass tests

import assert as A
import prelude as P
import typeclass::hash as Hash
import typeclass::equality as Eq

open A exposing assert-eq end
open Eq exposing Equality end

module test::typeclass::hash contains
  define transparent main as compute
    perform (P::sequence-unit
      [
        (assert-eq Natural (Hash::hash-value Natural 42) 42)
      , (assert-eq Natural (Hash::hash-value Boolean false) 0)
      , (assert-eq Natural (Hash::hash-value Boolean true) 1)
      , (assert-eq Natural (Hash::hash-value String "") 0)
      , (assert-eq Natural (Hash::hash-value String "a") 97)
      , (assert-eq Natural (Hash::hash-value String "ab") 3105)
      , (assert-eq Natural (Hash::hash-value (List Natural) [1, 2]) 33)
      , (assert-eq Natural (Hash::hash-value (List Natural) [1, 2, 3]) 1026)
      , (assert-eq Natural (Hash::hash-value (Pair Natural Natural)
          (P::pair Natural Natural 1 2)) 33)
      , (assert-eq Natural (Hash::hash-value (Pair Boolean Boolean)
          (P::pair Boolean Boolean true false)) 31)
      ])
  end
end
