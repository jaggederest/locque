# Tests for Default typeclass
import prelude as P
import assert as A
import typeclass::default as Default
import typeclass::equality as Eq
import string as S

open Default exposing Default default-value end

module test::typeclass::default contains

  # Generic helper (typeclass constraint supplies default-value)
  define transparent get-default as
    function A Type0 requires Default A returns A value
      default-value tt
    end

  # Test values
  define transparent test-nat-default as get-default Natural
  define transparent test-str-default as get-default String
  define transparent test-bool-default as get-default Boolean

  define transparent main as compute
    perform (P::sequence-unit
      [
        (A::assert-eq Natural test-nat-default 0)
      , (A::assert-eq String test-str-default "")
      , (A::assert-eq Boolean test-bool-default false)
      ])
  end
end
