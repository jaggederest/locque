# Tests for Default typeclass
import assert as A
import prelude as P

module test::typeclass::default contains
  # Default typeclass definition
  define transparent Default as typeclass A where
    default-value of-type for-all u as Unit to A
  end

  # Instance: Natural
  define transparent Default-Natural as instance Default Natural where
    default-value as function u Unit returns Natural value
      0
    end
  end

  # Instance: String
  define transparent Default-String as instance Default String where
    default-value as function u Unit returns String value
      ""
    end
  end

  # Instance: Boolean
  define transparent Default-Boolean as instance Default Boolean where
    default-value as function u Unit returns Boolean value
      false
    end
  end

  # Instance: List
  define transparent Default-List as instance Default (List A) where
    default-value as function u Unit returns (List A) value
      List::empty A
    end
  end

  # Instance: Unit
  define transparent Default-Unit as instance Default Unit where
    default-value as function u Unit returns Unit value
      tt
    end
  end

  # Generic helper (typeclass constraint supplies default-value)
  define transparent get-default as
    function A Type0 requires Default A returns A value
      default-value tt
    end

  # Test values
  define transparent test-nat-default as get-default Natural
  define transparent test-str-default as get-default String
  define transparent test-bool-default as get-default Boolean

  define transparent main as compute
    sequence
      (A::assert-eq Natural test-nat-default 0)
      (A::assert-eq String test-str-default "")
      (A::assert-eq Boolean test-bool-default false)
    end
  end
end
