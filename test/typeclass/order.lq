# Tests for Order typeclasses
# NOTE: Multi-arg typeclass methods are curried; application is left-associative.
import assert as A
import typeclass::order as Order
import typeclass::equality as Eq

open Order exposing LessThan LessOrEqual GreaterThan GreaterOrEqual less-than less-or-equal greater-than greater-or-equal end

module test::typeclass::order contains

  # Generic helpers with constraints
  define transparent less-than-value as
    function A Type0 x A y A requires LessThan A returns Boolean value
      less-than A x y
    end

  define transparent less-or-equal-value as
    function A Type0 x A y A requires LessOrEqual A returns Boolean value
      less-or-equal A x y
    end

  define transparent greater-than-value as
    function A Type0 x A y A requires GreaterThan A returns Boolean value
      greater-than A x y
    end

  define transparent greater-or-equal-value as
    function A Type0 x A y A requires GreaterOrEqual A returns Boolean value
      greater-or-equal A x y
    end

  # Test Natural lt
  define transparent test-nat-lt-yes as less-than-value Natural 5 10
  define transparent test-nat-lt-no as less-than-value Natural 10 5
  define transparent test-nat-lt-eq as less-than-value Natural 5 5

  # Test Natural le
  define transparent test-nat-le-yes as less-or-equal-value Natural 5 10
  define transparent test-nat-le-eq as less-or-equal-value Natural 5 5
  define transparent test-nat-le-no as less-or-equal-value Natural 10 5

  # Test Natural gt
  define transparent test-nat-gt-yes as greater-than-value Natural 10 5
  define transparent test-nat-gt-no as greater-than-value Natural 5 10
  define transparent test-nat-gt-eq as greater-than-value Natural 5 5

  # Test Natural ge
  define transparent test-nat-ge-yes as greater-or-equal-value Natural 10 5
  define transparent test-nat-ge-eq as greater-or-equal-value Natural 5 5
  define transparent test-nat-ge-no as greater-or-equal-value Natural 5 10

  # Test Boolean ordering (false < true)
  define transparent test-bool-lt-ff as less-than-value Boolean false false
  define transparent test-bool-lt-ft as less-than-value Boolean false true
  define transparent test-bool-lt-tf as less-than-value Boolean true false
  define transparent test-bool-lt-tt as less-than-value Boolean true true

  define transparent test-bool-le-ff as less-or-equal-value Boolean false false
  define transparent test-bool-le-ft as less-or-equal-value Boolean false true
  define transparent test-bool-le-tf as less-or-equal-value Boolean true false
  define transparent test-bool-le-tt as less-or-equal-value Boolean true true

  # Test with variables (ETyped)
  define transparent test-nat-lt-var as
    function x Natural y Natural returns Boolean value
      less-than-value Natural x y
    end

  define transparent main as compute
    sequence
      (A::assert-eq Boolean test-nat-lt-yes true)
      (A::assert-eq Boolean test-nat-lt-no false)
      (A::assert-eq Boolean test-nat-lt-eq false)
      (A::assert-eq Boolean test-nat-le-yes true)
      (A::assert-eq Boolean test-nat-le-eq true)
      (A::assert-eq Boolean test-nat-le-no false)
      (A::assert-eq Boolean test-nat-gt-yes true)
      (A::assert-eq Boolean test-nat-gt-no false)
      (A::assert-eq Boolean test-nat-gt-eq false)
      (A::assert-eq Boolean test-nat-ge-yes true)
      (A::assert-eq Boolean test-nat-ge-eq true)
      (A::assert-eq Boolean test-nat-ge-no false)
      (A::assert-eq Boolean test-bool-lt-ff false)
      (A::assert-eq Boolean test-bool-lt-ft true)
      (A::assert-eq Boolean test-bool-lt-tf false)
      (A::assert-eq Boolean test-bool-lt-tt false)
      (A::assert-eq Boolean test-bool-le-ff true)
      (A::assert-eq Boolean test-bool-le-ft true)
      (A::assert-eq Boolean test-bool-le-tf false)
      (A::assert-eq Boolean test-bool-le-tt true)
      (A::assert-eq Boolean (test-nat-lt-var 3 7) true)
      (A::assert-eq Boolean (test-nat-lt-var 7 3) false)
    end
  end
end
