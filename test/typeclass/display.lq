# Tests for Display typeclass
import assert as A
import prelude as P
import typeclass::display as Display
import typeclass::equality as Eq
import string as S

open Display exposing Display display end

module test::typeclass::display contains

  # Generic helper with constraint
  define transparent display-value as
    function A Type0 x A requires Display A returns String value
      display x
    end

  # Test Natural display
  define transparent test-nat-zero as display-value Natural 0
  define transparent test-nat-42 as display-value Natural 42
  define transparent test-nat-large as display-value Natural 12345

  # Test String display
  define transparent test-str-empty as display-value String ""
  define transparent test-str-hello as display-value String "hello"

  # Test Boolean display
  define transparent test-bool-true as display-value Boolean true
  define transparent test-bool-false as display-value Boolean false

  # Test List display
  define transparent test-list-empty as
    display-value (List Natural) (of-type [] (List Natural))
  define transparent test-list-nats as display-value (List Natural) [1, 2]

  # Test Pair display
  define transparent test-pair-basic as
    display-value (Pair Natural Natural) (P::pair Natural Natural 1 2)
  define transparent test-pair-words as
    display-value (Pair String String) (P::pair String String "hi" "bye")

  # Test with variables (ETyped)
  define transparent test-nat-display-var as
    function n Natural returns String value
      display-value Natural n
    end

  define transparent test-str-display-var as
    function s String returns String value
      display-value String s
    end

  define transparent test-bool-display-var as
    function b Boolean returns String value
      display-value Boolean b
    end

  define transparent main as compute
    perform (P::sequence-unit
      [
        (A::assert-eq String test-nat-zero "0")
      , (A::assert-eq String test-nat-42 "42")
      , (A::assert-eq String test-nat-large "12345")
      , (A::assert-eq String test-str-empty "\"\"")
      , (A::assert-eq String test-str-hello "\"hello\"")
      , (A::assert-eq String test-bool-true "true")
      , (A::assert-eq String test-bool-false "false")
      , (A::assert-eq String test-list-empty "[]")
      , (A::assert-eq String test-list-nats "[1, 2]")
      , (A::assert-eq String test-pair-basic "(1, 2)")
      , (A::assert-eq String test-pair-words "(\"hi\", \"bye\")")
      , (A::assert-eq String (test-nat-display-var 99) "99")
      , (A::assert-eq String (test-str-display-var "world") "\"world\"")
      , (A::assert-eq String (test-bool-display-var true) "true")
      , (A::assert-eq String (test-bool-display-var false) "false")
      ])
  end
end
