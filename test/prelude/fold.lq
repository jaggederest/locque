# Migrated from ../03_fold.lq

import prelude as P
import assert as A

module test::prelude::fold contains
  define transparent list123 as
    P::cons String "1"
      (P::cons String "2"
        (P::cons String "3" (P::nil String)))

  define transparent sum-total as
    P::fold String String concat-string-prim "" list123

  define transparent sum-list as compute
    sequence
      (A::assert-eq-string sum-total "123")
    end
  end

  define transparent map-upper-list as
    P::map String String
      (function x String returns String value
        concat-string-prim x "!"
      end)
      list123

  define transparent map-upper-total as
    P::fold String String concat-string-prim "" map-upper-list

  define transparent map-upper as compute
    sequence
      (A::assert-eq-string map-upper-total "1!2!3!")
    end
  end

  define transparent main as compute
    sequence
      sum-list
      map-upper
    end
  end
end
