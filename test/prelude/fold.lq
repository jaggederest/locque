# Migrated from ../03_fold.lq

import prelude as P
import assert as A
import string as S
import typeclass::equality as Eq

module test::prelude::fold contains
  define transparent list123 as
    ["1", "2", "3"]

  define transparent sum-total as
    P::fold String String S::concat "" list123

  define transparent sum-list as compute
    perform (P::sequence-unit
      [
        (A::assert-eq String sum-total "123")
      ])
  end

  define transparent map-upper-list as
    P::map String String
      (function x String returns String value
        S::concat x "!"
      end)
      list123

  define transparent map-upper-total as
    P::fold String String S::concat "" map-upper-list

  define transparent map-upper as compute
    perform (P::sequence-unit
      [
        (A::assert-eq String map-upper-total "1!2!3!")
      ])
  end

  define transparent main as compute
    perform (P::sequence-unit
      [
        sum-list
      , map-upper
      ])
  end
end
