# Migrated from ../04_match.lq

import prelude as P
import assert as A

module test::prelude::match contains
  define transparent bool-match as compute
    sequence
      (A::assert-eq-string
        (P::if-bool String (P::not false) "true-branch" "false-branch")
        "true-branch")
    end
  end

  define transparent list-match as compute
    bind result from return
      (match (P::cons String "x" (P::nil String)) of-type (List String) as ignored returns String
        empty-case as "empty"
        cons-case with h String t (List String) as h
      end)
    then
      sequence
        (A::assert-eq-string result "x")
      end
    end
  end

  define transparent main as compute
    sequence
      bool-match
      list-match
    end
  end
end
