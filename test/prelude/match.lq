# Migrated from ../04_match.lq

import prelude as P
import assert as A

module test::prelude::match contains
  define transparent bool-match as compute
    sequence
      (A::assert-eq String
        (match (P::not false) of-type Boolean as ignored returns String
          case Boolean::false as "false-branch"
          case Boolean::true as "true-branch"
        end)
        "true-branch")
    end
  end

  define transparent list-match as compute
    bind result from return
      (match (P::cons String "x" (P::nil String)) of-type (List String) as ignored returns String
        case List::empty as "empty"
        case List::cons with h String t (List String) as h
      end)
    then
      sequence
        (A::assert-eq String result "x")
      end
    end
  end

  define transparent main as compute
    sequence
      bool-match
      list-match
    end
  end
end
