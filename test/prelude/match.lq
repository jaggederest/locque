# Migrated from ../04_match.lq

import prelude as P
import assert as A
import typeclass::equality as Eq
import string as S

module test::prelude::match contains
  define transparent bool-match as compute
    perform (P::sequence-unit
      [
        (A::assert-eq String
                                                (match (P::not false) of-type Boolean as ignored returns String
                                                  case Boolean::false as "false-branch"
                                                  case Boolean::true as "true-branch"
                                                end)
                                                "true-branch")
      ])
  end

  define transparent list-match as compute
    bind result from return
      (match ["x"] of-type (List String) as ignored returns String
        case List::empty as "empty"
        case List::cons with h String t (List String) as h
      end)
    then
      perform (P::sequence-unit
        [
          (A::assert-eq String result "x")
        ])
    end
  end

  define transparent main as compute
    perform (P::sequence-unit
      [
        bool-match
      , list-match
      ])
  end
end
