import prelude as P
import assert as A

module LFoldTests contains

  define transparent list123 as value
    P.cons "1" (P.cons "2" (P.cons "3" P.nil))

  define transparent sum-list as computation
    bind P.fold concat-string-prim "" list123 as total then
    bind perform io (A.assert-eq-string total "123") as _ then
    return P.tt

  define transparent map-upper as computation
    bind P.map (function x of-type String produce concat-string-prim x "!") list123 as mapped then
    bind P.fold concat-string-prim "" mapped as total then
    bind perform io (A.assert-eq-string total "1!2!3!") as _ then
    return P.tt

  define transparent main as computation
    bind sum-list as _ then
    bind map-upper as _ then
    return P.tt
end
