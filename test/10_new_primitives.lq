import prelude as P
import assert as A
import string as S
import list as L

module LNewPrimitivesTest contains

  define transparent test-ends-with as computation
    bind perform io (A.assert-eq-string (P.if-bool (S.string-ends-with "" "hello") "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.string-ends-with "lo" "hello") "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.string-ends-with "hello" "hello") "yes" "no") "yes") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.string-ends-with "hi" "hello") "yes" "no") "no") as _ then
    bind perform io (A.assert-eq-string (P.if-bool (S.string-ends-with "ello" "hello") "yes" "no") "yes") as _ then
    return P.tt

  define transparent test-index-of as computation
    bind perform io (A.assert-eq-nat (S.string-index-of "ell" "hello") 1) as _ then
    bind perform io (A.assert-eq-nat (S.string-index-of "h" "hello") 0) as _ then
    bind perform io (A.assert-eq-nat (S.string-index-of "o" "hello") 4) as _ then
    bind perform io (A.assert-eq-nat (S.string-index-of "xyz" "hello") 5) as _ then
    bind perform io (A.assert-eq-nat (S.string-index-of "lo" "hello") 3) as _ then
    return P.tt

  define transparent test-list-last-init as computation
    bind P.cons "a" (P.cons "b" (P.cons "c" P.nil)) as lst then
    bind perform io (A.assert-eq-string (L.list-last lst) "c") as _ then
    bind L.list-init lst as init-list then
    bind perform io (A.assert-eq-nat (P.length-list init-list) 2) as _ then
    bind perform io (A.assert-eq-string (L.nth 0 init-list) "a") as _ then
    bind perform io (A.assert-eq-string (L.nth 1 init-list) "b") as _ then
    bind P.cons "x" P.nil as single then
    bind perform io (A.assert-eq-string (L.list-last single) "x") as _ then
    bind L.list-init single as empty-init then
    bind perform io (A.assert-eq-nat (P.length-list empty-init) 0) as _ then
    return P.tt

  define transparent main as computation
    bind test-ends-with as _ then
    bind test-index-of as _ then
    bind test-list-last-init as _ then
    return P.tt
end
