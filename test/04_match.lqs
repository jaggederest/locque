(import Prelude P)
(import Assert A)

(module MatchTests
  (def transparent bool-match
    (computation
      (do
        (bind _ (perform io (A.assert-eq-string (if-bool (P.not false) "true-branch" "false-branch") "true-branch")))
        (return P.tt))))

  (def transparent list-match
    (computation
      (do
        (bind lst (P.cons "x" P.nil))
        (bind res (P.match lst (lambda () "empty") (lambda ((h String)) (lambda ((t (List String))) h))))
        (bind _ (perform io (A.assert-eq-string res "x")))
        (return P.tt))))

  (def transparent main
    (computation
      (do
        (bind _ bool-match)
        (bind _ list-match)
        (return P.tt)))))
