import prelude as P
# File IO smoke tests

import file as File
import assert as A
import typeclass::equality as Eq
import string as S

open A exposing assert-eq end
open Eq exposing Equality end

module test::file::file_io contains
  define transparent roundtrip as compute
    perform
      (P::bind-comp Unit Unit
        (File::write-file "test/tmp/test_tmp.txt" "abc")
        (function ignored Unit returns computation Unit value
          P::bind-comp String Unit
            (File::read-file "test/tmp/test_tmp.txt")
            (function contents String returns computation Unit value
              assert-eq String contents "abc"
            end)
        end))
  end

  define transparent main as compute
    perform (P::sequence-unit
      [
        roundtrip
      ])
  end
end
