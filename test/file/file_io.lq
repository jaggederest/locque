import prelude as P
# File IO smoke tests

import file as File
import assert as A
import typeclass::equality as Eq
import string as S

open A exposing assert-eq end
open Eq exposing Equality end

module test::file::file_io contains
  define transparent roundtrip as compute
    bind ignored from perform (File::write-file "test/tmp/test_tmp.txt" "abc") then
      bind contents from perform (File::read-file "test/tmp/test_tmp.txt") then
        perform (assert-eq String contents "abc")
      end
    end
  end

  define transparent main as compute
    perform (P::sequence-unit
      [
        roundtrip
      ])
  end
end
