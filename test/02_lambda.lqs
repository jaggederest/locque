(import Prelude P)
(import Assert A)

(module LambdaTests
  (def transparent id
    (value (lambda ((x String)) x)))

  (def transparent apply-id
    (computation
      (do
        (bind res (id "hi"))
        (bind _ (perform io (A.assert-eq-string res "hi")))
        (return P.tt))))

  (def transparent main
    (computation
      (do
        (bind _ apply-id)
        (return P.tt)))))
