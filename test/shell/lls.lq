# Tests for lls

import shell::lls as Lls
import file as File
import string as Str
import assert as A
import prelude as P
import test::helpers as TH
import typeclass::equality as Eq

open A exposing assert-eq end
open Eq exposing Equality end

module test::shell::lls contains
  define transparent main as
    P::and-then Unit Unit
      (function ignored Unit returns computation Unit value
        P::bind-comp (List String) Unit
          (TH::assert-output-contains (List String) "lls_check.txt" (Lls::lls "test/tmp"))
          (function files (List String) returns computation Unit value
            assert-eq Boolean
              (Str::has-substring "lls_check.txt" (Str::join-with "\n" files))
              true
          end)
      end)
      (File::write-file "test/tmp/lls_check.txt" "ok")
end
