# Tests for lls

import shell::lls as Lls
import file as File
import string as Str
import assert as A
import test::helpers as TH
import typeclass::equality as Eq

open A exposing assert-eq end
open Eq exposing Equality end

module test::shell::lls contains
  define transparent main as compute
    bind ignored from perform (File::write-file "test/tmp/lls_check.txt" "ok") then
      bind files from perform (TH::assert-output-contains (List String) "lls_check.txt" (Lls::lls "test/tmp")) then
        perform
          (assert-eq Boolean
            (Str::string-contains "lls_check.txt" (Str::join-with "\n" files))
            true)
      end
    end
  end
end
