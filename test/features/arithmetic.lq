# Migrated from ../08_arithmetic.lq

import Prelude as P
import Assert as A
import Arithmetic as Ar

module ArithmeticTests contains

  define transparent test-min-max as computation
    bind _ <- perform io (A.assert-eq-nat (Ar.min 5 3) 3) then
    bind _ <- perform io (A.assert-eq-nat (Ar.min 2 8) 2) then
    bind _ <- perform io (A.assert-eq-nat (Ar.min 7 7) 7) then
    bind _ <- perform io (A.assert-eq-nat (Ar.max 5 3) 5) then
    bind _ <- perform io (A.assert-eq-nat (Ar.max 2 8) 8) then
    bind _ <- perform io (A.assert-eq-nat (Ar.max 7 7) 7) then
    return P.tt

  define transparent test-abs-diff as computation
    bind _ <- perform io (A.assert-eq-nat (Ar.abs-diff 10 3) 7) then
    bind _ <- perform io (A.assert-eq-nat (Ar.abs-diff 3 10) 7) then
    bind _ <- perform io (A.assert-eq-nat (Ar.abs-diff 5 5) 0) then
    return P.tt

  define transparent test-clamp as computation
    bind _ <- perform io (A.assert-eq-nat (Ar.clamp 10 20 15) 15) then
    bind _ <- perform io (A.assert-eq-nat (Ar.clamp 10 20 5) 10) then
    bind _ <- perform io (A.assert-eq-nat (Ar.clamp 10 20 25) 20) then
    bind _ <- perform io (A.assert-eq-nat (Ar.clamp 10 20 10) 10) then
    bind _ <- perform io (A.assert-eq-nat (Ar.clamp 10 20 20) 20) then
    return P.tt

  define transparent test-even-odd as computation
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.even 0) "yes" "no") "yes") then
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.even 2) "yes" "no") "yes") then
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.even 1) "yes" "no") "no") then
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.even 42) "yes" "no") "yes") then
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.odd 1) "yes" "no") "yes") then
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.odd 2) "yes" "no") "no") then
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.odd 17) "yes" "no") "yes") then
    return P.tt

  define transparent test-is-zero-positive as computation
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.is-zero 0) "yes" "no") "yes") then
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.is-zero 1) "yes" "no") "no") then
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.is-positive 0) "yes" "no") "no") then
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.is-positive 1) "yes" "no") "yes") then
    bind _ <- perform io (A.assert-eq-string (P.if-bool (Ar.is-positive 100) "yes" "no") "yes") then
    return P.tt

  define transparent main as computation
    bind _ <- test-min-max then
    bind _ <- test-abs-diff then
    bind _ <- test-clamp then
    bind _ <- test-even-odd then
    bind _ <- test-is-zero-positive then
    return P.tt
end
