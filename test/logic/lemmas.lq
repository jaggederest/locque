# Proof-style lemmas (guide)

import arithmetic as Ar
import logic as L

module test::logic::lemmas contains
  define transparent symm-lemma as
    of-type
      (L::symmetry Natural 5 5 (reflexive Natural 5))
      (equal Natural 5 5)

  define transparent trans-lemma as
    of-type
      (L::transitivity Natural 5 5 5
        (reflexive Natural 5)
        (reflexive Natural 5))
      (equal Natural 5 5)

  define transparent cong-lemma as
    of-type
      (L::congruence Natural Natural
        (function n Natural returns Natural value
          Ar::add n 0
        end)
        7
        7
        (reflexive Natural 7))
      (equal Natural (Ar::add 7 0) (Ar::add 7 0))

  define transparent cong2-lemma as
    of-type
      (L::congruence2 Natural Natural Natural
        (function x Natural returns (for-all y as Natural to Natural) value
          function y Natural returns Natural value
            Ar::add x y
          end
        end)
        2
        2
        3
        3
        (reflexive Natural 2)
        (reflexive Natural 3))
      (equal Natural (Ar::add 2 3) (Ar::add 2 3))

  define transparent is-one as
    function n Natural returns Type0 value
      equal Natural n 1
    end

  define transparent One as
    L::Refine Natural is-one

  define transparent one-refine as
    of-type
      (pack n as Natural in is-one n with 1 (reflexive Natural 1) end)
      (L::Refine Natural is-one)

  define transparent refine-value-lemma as
    of-type
      (L::refine-value Natural is-one one-refine)
      Natural

  define transparent refine-with-lemma as
    of-type
      (L::refine-with Natural
        is-one
        Natural
        one-refine
        (function n Natural proof (equal Natural n 1) returns Natural value
          n
        end))
      Natural

  define transparent transport-const as
    of-type
      (L::transport Natural
        (function ignored Natural returns Type0 value Natural end)
        3
        3
        (reflexive Natural 3)
        3)
      Natural

  define transparent main as compute
    return tt
  end
end
