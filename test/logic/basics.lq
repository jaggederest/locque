# Logic module basics

import assert as A
import list::eq as ListEq
import logic as L
import pair::eq as PairEq
import prelude as P
import typeclass::equality as Eq

open A exposing assert-eq end
open Eq exposing Equality end

module test::logic::basics contains
  define transparent false-type as
    of-type L::False Type0

  define transparent not-false as
    of-type
      (function x L::False returns L::False value x end)
      (L::Not L::False)

  define transparent decidable-nat-true-type as
    of-type (L::decide-eq-nat 5 5) (L::Decidable (equal Natural 5 5))

  define transparent decidable-nat-false-type as
    of-type (L::decide-eq-nat 5 6) (L::Decidable (equal Natural 5 6))

  define transparent decide-nat-true as
    unpack (L::decide-eq-nat 5 5) as b ignored in b end

  define transparent decide-nat-false as
    unpack (L::decide-eq-nat 5 6) as b ignored in b end

  define transparent decide-string-true as
    unpack (L::decide-eq-string "hi" "hi") as b ignored in b end

  define transparent decide-string-false as
    unpack (L::decide-eq-string "hi" "bye") as b ignored in b end

  define transparent decide-bool-true as
    unpack (L::decide-eq-bool true true) as b ignored in b end

  define transparent decide-bool-false as
    unpack (L::decide-eq-bool true false) as b ignored in b end

  define transparent decide-pair-true as
    unpack
      (PairEq::decide-eq Natural Boolean L::decide-eq-nat L::decide-eq-bool
        (P::pair Natural Boolean 1 true)
        (P::pair Natural Boolean 1 true))
      as b ignored in b end

  define transparent decide-pair-false as
    unpack
      (PairEq::decide-eq Natural Boolean L::decide-eq-nat L::decide-eq-bool
        (P::pair Natural Boolean 1 true)
        (P::pair Natural Boolean 2 true))
      as b ignored in b end

  define transparent decide-list-true as
    unpack
      (ListEq::decide-eq Natural L::decide-eq-nat
        [1, 2]
        [1, 2])
      as b ignored in b end

  define transparent decide-list-false as
    unpack
      (ListEq::decide-eq Natural L::decide-eq-nat
        [1, 2]
        [1, 3])
      as b ignored in b end

  define transparent test-decisions as compute
    perform (P::sequence-unit
      [
        (assert-eq Boolean decide-nat-true true)
      , (assert-eq Boolean decide-nat-false false)
      , (assert-eq Boolean decide-string-true true)
      , (assert-eq Boolean decide-string-false false)
      , (assert-eq Boolean decide-bool-true true)
      , (assert-eq Boolean decide-bool-false false)
      , (assert-eq Boolean decide-pair-true true)
      , (assert-eq Boolean decide-pair-false false)
      , (assert-eq Boolean decide-list-true true)
      , (assert-eq Boolean decide-list-false false)
      ])
  end

  define transparent main as compute
    perform test-decisions
  end
end
