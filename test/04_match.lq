import prelude as P
import assert as A

module LMatchTests contains

  define transparent bool-match as computation
    bind perform io (A.assert-eq-string (if-bool (P.not false) "true-branch" "false-branch") "true-branch") as _ then
    return P.tt

  define transparent list-match as computation
    bind perform io (A.assert-eq-string (P.match-list (P.cons "x" P.nil) (lambda -> "empty") (lambda h -> (lambda t -> h))) "x") as _ then
    return P.tt

  define transparent main as computation
    bind bool-match as _ then
    bind list-match as _ then
    return P.tt
end
