# Test constraint resolution
import assert as A

module test::typecheck::typeclass_resolution contains
  # Define a simple typeclass
  define transparent Show as typeclass A where
    show of-type for-all x as A to String
  end

  # Define instances
  define transparent Show-Natural as instance Show Natural where
    show as function x Natural returns String value
      "nat"
    end
  end

  define transparent Show-Boolean as instance Show Boolean where
    show as function x Boolean returns String value
      "bool"
    end
  end

  define transparent show-value as
    function A Type0 x A requires Show A returns String value
      show x
    end

  # Test: using show with concrete Natural type should resolve
  define transparent test-show-nat as
    show-value Natural 42

  # Test: using show with concrete Boolean type should resolve
  define transparent test-show-bool as
    show-value Boolean true

  define transparent main as compute
    sequence
      (A::assert-eq-string test-show-nat "nat")
      (A::assert-eq-string test-show-bool "bool")
    end
  end
end
