# Migrated from ../99_typecheck_match.lq

import prelude as P
import assert as A

module test::typecheck::match contains
  define transparent test-list-match as compute
    bind result from return
      (match (P::cons String "first" (P::nil String)) of-type (List String) as ignored returns String
        case List::empty as "empty"
        case List::cons with h String t (List String) as h
      end)
    then
      sequence
        (A::assert-eq String result "first")
      end
    end
  end

  define transparent test-bool-match as compute
    bind result from return
      (match true of-type Boolean as ignored returns String
        case Boolean::false as "false"
        case Boolean::true as "true"
      end)
    then
      sequence
        (A::assert-eq String result "true")
      end
    end
  end

  define transparent test-pair-match as compute
    bind result from return
      (match (P::pair String Natural "hello" 42) of-type (Pair String Natural) as ignored returns Natural
        case Pair::pair with s String n Natural as n
      end)
    then
      sequence
        (A::assert-eq Natural result 42)
      end
    end
  end

  define transparent main as compute
    sequence
      test-list-match
      test-bool-match
      test-pair-match
    end
  end
end
