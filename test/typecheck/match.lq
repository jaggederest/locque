# Migrated from ../99_typecheck_match.lq

import prelude as P
import assert as A

module LTypeCheckMatch contains
  define transparent test-list-match as computation
    bind perform io (A.assert-eq-string
      (P.match-list (P.cons "first" P.nil)
        (lambda -> "empty")
        (lambda h -> lambda t -> h))
      "first") as _ then
    return P.tt

  define transparent test-bool-match as computation
    bind perform io (A.assert-eq-string
      (P.match-bool true
        (lambda -> "false")
        (lambda -> "true"))
      "true") as _ then
    return P.tt

  define transparent test-pair-match as computation
    bind perform io (A.assert-eq-nat
      (P.match-pair (P.pair "hello" 42)
        (lambda -> 0)
        (lambda s -> lambda n -> n))
      42) as _ then
    return P.tt

  define transparent main as computation
    bind test-list-match as _ then
    bind test-bool-match as _ then
    bind test-pair-match as _ then
    return P.tt
end
