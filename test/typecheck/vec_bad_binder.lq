# Expected type error: binder type does not match constructor field.

import prelude as P
import type_aliases as Types

module test::typecheck::vec_bad_binder contains
  define transparent Peano as data in Type0
    case Peano::zero of-type Peano
    case Peano::succ of-type Types::Function Peano Peano
  end

  define transparent Vec as data A Type0 n Peano in Type0
    case Vec::nil of-type Vec A Peano::zero
    case Vec::cons of-type
      for-all n as Peano to
      Types::Function A
        (Types::Function
          (Vec A n)
          (Vec A (Peano::succ n)))
  end

  define transparent bad as
    function A Type0 n Peano xs (Vec A n) returns Natural value
      match xs of-type (Vec A n) as ignored returns Natural
        case Vec::nil as 0
        case Vec::cons with k Peano h A t (Vec A (Peano::succ k)) as 1
      end
    end

  define transparent main as compute
    return tt
  end
end
