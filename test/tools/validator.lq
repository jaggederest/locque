import assert as A
import tools::validator as V
import typeclass::equality as Eq

module test::tools::validator contains
  define transparent valid-source as
    "module sample::ok contains\n  define transparent main as compute\n    return tt\n  end\nend\n"

  define transparent invalid-source as
    "module sample::bad contains\n  define transparent main as compute\n    return tt\n  end\n"

  define transparent main as compute
    sequence
      (A::assert-eq Boolean (V::validate-string valid-source) true)
      (A::assert-eq Boolean (V::validate-string invalid-source) false)
    end
  end
end
