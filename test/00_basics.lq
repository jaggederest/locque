import Prelude as P
import Assert as A
import IO as IO
import String as S
import Prelude as P

module Basics contains

  define transparent check-add as computation
    bind _ <- perform io (A.assert-eq-nat (P.add-nat 2 3) 5) then
    return P.tt

  define transparent check-string as computation
    bind _ <- perform io (A.assert-eq-string "hi" "hi") then
    return P.tt

  define transparent check-output as computation
    bind _ <- perform io (IO.print "Hello, test!") then
    return P.tt

  define transparent check-string-length as computation
    bind _ <- perform io (A.assert-eq-nat (S.length "abcd") 4) then
    return P.tt

  define transparent check-string-split-join as computation
    bind _ <- perform io (A.assert-eq-string (S.join-with "-" (S.split-on "-" "a-b-c")) "a-b-c") then
    return P.tt

  define transparent check-split-spaces as computation
    bind _ <- perform io (A.assert-eq-string (S.join-with "-" (S.split-spaces " a  b c ")) "a-b-c") then
    return P.tt

  define transparent main as computation
    bind _ <- check-add then
    bind _ <- check-string then
    bind _ <- check-string-length then
    bind _ <- check-string-split-join then
    bind _ <- check-split-spaces then
    bind _ <- check-output then
    return P.tt
end
